// no need to wait for the DOM, we live dangerously here
const el = document.getElementById("pacman");
const featureChecks = {
  canvas: "dazzling and probably unnecessary page visuals",
  localstorage: "creepily remember everything about you",
  audio: "the sweet, sweet sounds of an 80's arcade",
  'audio.ogg': "quality tunage",
  'audio.mp3': "backup quality tunage"
};

function canHazFeatures() {
  return Object.entries(featureChecks).every(([feature, desc]) => {
    let propExists = feature.includes('.') ? Modernizr[feature.split('.')[0]][feature.split('.')[1]] : Modernizr[feature];
    if (!propExists) {
      showSorryMessage(feature, desc);
    }
    return propExists;
  });
}

function showSorryMessage(missingFeature, description) {
  el.innerHTML += `You're missing out on: ${description}.<br>`;
}

if (canHazFeatures()) {
  window.setTimeout(() => PACMAN.init(el, "./"), 0);
} else {
  el.innerHTML += "<br><small>(Upgrade your browser, granddad! firefox 3.6+, Chrome 4+, Opera 10+ and Safari 4+)</small>";
}
